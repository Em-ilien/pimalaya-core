[package]
name = "email-lib"
version = "0.20.1"
description = "Rust library to manage emails"
homepage = "https://pimalaya.org"
documentation = "https://docs.rs/email-lib/latest/email/"
repository = "https://git.sr.ht/~soywod/pimalaya/tree/master/item/email/README.md"
authors = ["soywod <clement.douin@posteo.net>"]
edition = "2021"
license = "MIT"
categories = ["email", "network-programming"]
keywords = ["email", "maildir", "imap", "smtp", "sendmail"]

[package.metadata.docs.rs]
all-features = true
rustdoc-args = ["--cfg", "docsrs"]

[lib]
name = "email"

[features]
default = [
  "imap",
  "maildir",
  # "notmuch",
  "smtp",
  "sendmail",
  # "account-discovery",
  "folder",
  "envelope",
  "flag",
  "message",
  "sync",
  # "pgp-commands",
  # "pgp-gpg",
  # "pgp-native",
]
imap = ["dep:futures", "dep:imap", "imap-proto", "utf7-imap"]
maildir = ["maildirpp", "notify", "rayon"]
notmuch = ["dep:notmuch"]
smtp = ["mail-send"]
sendmail = []
account-discovery = ["dep:email_address", "dep:futures", "dep:bytes", "dep:hickory-resolver", "dep:hyper", "dep:hyper-rustls", "dep:quick-xml"]
folder = ["folder-add", "folder-list", "folder-expunge", "folder-purge", "folder-delete"]
folder-add = []
folder-list = []
folder-expunge = []
folder-purge = []
folder-delete = []
envelope = ["envelope-list", "envelope-watch", "envelope-get"]
envelope-list = []
envelope-watch = ["notify-rust"]
envelope-get = []
flag = ["flag-add", "flag-set", "flag-remove"]
flag-add = []
flag-set = []
flag-remove = []
message = ["message-add", "message-peek", "message-get", "message-copy", "message-move", "message-delete", "message-send"]
message-add = []
message-peek = []
message-get = []
message-copy = []
message-move = []
message-delete = []
message-send = []
sync = [
  "folder-add", "folder-list", "folder-expunge", "folder-delete",
  "envelope-get", "envelope-list",
  "flag-add", "flag-set",
  "message-add", "message-peek", "message-get", "message-move",
  "advisory-lock",
  "dirs",
  "dep:futures",
  "maildir",
  "rusqlite",
]
pgp = []
pgp-commands = ["pgp", "mml-lib/pgp-commands"]
pgp-gpg = ["pgp", "mml-lib/pgp-gpg"]
pgp-native = ["pgp", "keyring-lib", "mml-lib/pgp-native", "pgp-lib"]

[dev-dependencies]
concat-with = "0.2"
env_logger = "0.10"
tempfile = "3.3"
tokio = { version = "1.23", default-features = false, features = ["macros", "rt", "rt-multi-thread", "time"] }

[dependencies]
advisory-lock = { version = "0.3", optional = true }
anyhow = "1.0"
async-trait = "0.1"
bytes = { version = "1", optional = true }
chrono = "0.4"
convert_case = "0.5"
dirs = { version = "4.0", optional = true }
futures = { version = "0.3", optional = true }
hickory-resolver = { version = "0.24", optional = true, features = ["dns-over-rustls"] }
hyper = { version = "0.14", optional = true, default-features = false, features = [ "http1", "http2" ] }
hyper-rustls = { version = "0.24", optional = true }
email_address = { version = "0.2.4", optional = true, default-features = false }
imap = { version = "=3.0.0-alpha.12", optional = true, default-features = false, features = ["rustls-tls"] }
imap-proto = { version = "=0.16.3", optional = true }
keyring-lib = { version = "=0.3.2", optional = true }
log = "0.4"
mail-builder = "0.3"
mail-parser = "0.9"
mail-send = { version = "0.4", optional = true }
maildirpp = { version = "=0.0.2", optional = true }
mml-lib = { version = "=1.0.7", default-features = false, features = ["compiler", "interpreter"] }
notify = { version = "6", optional = true, default-features = false, features = ["macos_kqueue"] }
notify-rust = { version = "4", optional = true }
notmuch = { version = "=0.8.0", optional = true }
oauth-lib = "=0.1.0"
once_cell = "1"
ouroboros = "0.15"
pgp-lib = { version = "=0.1.0", optional = true }
process-lib = "=0.3.1"
rayon = { version = "1.6", optional = true }
regex = "1.5"
secret-lib = "=0.3.3"
quick-xml = { version = "0.31", optional = true, features = ["serialize"] }
serde = { version = "1.0", features = ["derive"] }
shellexpand-utils = "=0.2.0"
thiserror = "1"
tokio = { version = "1.23", default-features = false, features = ["fs", "net"] }
tokio-rustls = "0.25"
tree_magic_mini = "3"
urlencoding = "2.1"
utf7-imap = { version = "=0.3.2", optional = true }

[target.'cfg(target_env = "musl")'.dependencies]
rusqlite = { version = "0.29", optional = true, features = [] }

[target.'cfg(not(target_env = "musl"))'.dependencies]
rusqlite = { version = "0.29", optional = true, features = ["bundled"] }
